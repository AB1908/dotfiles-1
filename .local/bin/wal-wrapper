#!/usr/bin/env bash
#
# Wrapper script for pywal, doing all the extra needed
# operations for using a new colorscheme.
#
# Copyright (C) 2020 Rafael Cavalcanti - rafaelc.org
# Licensed under GPLv3

set -euo pipefail

wal "$@"

printf "\nRecompiling dwm...\n"
# Remove urg_ variables as we don't use the urgent patch.
sed -i '/ urg_/d' ~/.cache/wal/colors-wal-dwm.h
cd ~/Code/dwm && sudo make clean install > /dev/null

printf "\nRecompiling dmenu...\n"
cd ~/Code/dmenu && sudo make clean install > /dev/null

printf "\nRestarting dunst...\n"
killall dunst || true
dunst &
disown

printf "\nRestart dwm for using the new colorscheme.\n"

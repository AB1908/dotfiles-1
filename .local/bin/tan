#!/usr/bin/env bash
#
# Copyright (C) 2021 Rafael Cavalcanti - rafaelc.org
# Copyright (C) 2016 djp <djp@cutter>
#
# Distributed under terms of the MIT license.
#

readonly id="$*"
if ! echo "$id" | grep -q '[0-9]\+'; then
    echo "ERROR: command must be followed by a single task ID."
    exit 1
fi

readonly annot_file="$(mktemp)"
readonly editor="${EDITOR:-vi}"

$editor "$annot_file"

if [[ "$(wc -l "$annot_file")" -gt 1 ]]; then
    readonly annot="\n$(cat "$annot_file")"
else
    readonly annot="$(cat "$annot_file")"
fi

task "$id" annotate "$annot"

rm "$annot_file"


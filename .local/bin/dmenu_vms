#!/usr/bin/env bash
#
# dmenu script for running VMs
#
# Author: Rafael Cavalcanti - rafaelc.org

readonly options="$(virsh -c qemu:///session list --all --uuid --name)"

readonly chosen="$(cut -d ' ' -f2 <(printf "%s" "$options") | dmenu -p "vms:" "$@")"
[[ -z "$chosen" ]] && exit

readonly uuid="$(grep "\b${chosen}\b" <(printf "%s" "$options") | cut -d ' ' -f1)"
gnome-boxes --open-uuid "$uuid"

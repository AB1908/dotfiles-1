#!/bin/bash
#
# Conveniently provide youtube-dl options. Used on Termux.
#
# Copyright (C) 2019 Rafael Cavalcanti - rafaelc.org
# Licensed under GPLv3

export TOP_PID=$$

cmd() {
  printf "Select format:\n" >&2
  select option in "Default" "Audio" "Exit"; do
    case $option in
      "Default") echo "youtube-dl" && break ;;
      "Audio") echo "youtube-dl --extract-audio" && break ;;
      "Exit") kill -s TERM $TOP_PID && break ;;
      *) printf "Invalid option.\n" 1>&2;;
    esac
  done
}

usage() {
  echo "We need at least a url."
  exit
}

main() {
  [[ $# -eq 0 ]] && usage

  until $(cmd) "$@"; do
    echo "Try again."
  done
}

main "$@"

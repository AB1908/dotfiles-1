#
# Common Bash aliases for all systems
#
# Author: Rafael Cavalcanti


# ========================================
# FUNCTIONS
# ========================================

# Make Btrfs snapshot
if command -v snapper >/dev/null; then
	snap() {
		echo "Criaremos um snapshot do sistema. Home e data não estão inclusos."
		read -p "Descrição: " desc
		echo $desc
		sudo snapper -c @ create --description "$desc" --userdata "important=yes"
		sudo snapper -c @var create --description "$desc" --userdata "important=yes"
	}
fi
#LVM: alias snap="sudo lvcreate -s /dev/ssd/arch -n snap -L 5G && sudo lvcreate -s /dev/hdd/arch -n snap -L 5G"

# Mkdir and cd to it
mkdirr() {
	mkdir -p -- "$1" && cd -P -- "$1"
}

# Aux - mount if not, and cd
mount_and_cd() {
	[ $# -ne 1 ] && printf "Wrong number of arguments.\n" && return
	mount | grep "$1" > /dev/null || mount "$1" && cd "$1"
}

# Aux - set alias if path exists
# Args: alias_name command path
alias_if() {
	[ $# -ne 3 ] && printf "Wrong number of arguments.\n" && return
	[ -e "$3" ] && alias $1="$2 '$3'"
}

# ========================================


# Also check command after sudo for alias (see man bash)
alias sudo="sudo "
alias watch="watch "

# Increase verbosity and prompt before overwriting (for rm, prompt
# before removing directory or more than 3 files)
alias cp="cp -vi"
alias mv="mv -vi"
alias rm="rm -vI"
alias ln="ln -vi"

# Human-readable output
alias df="df -h"
alias free="free -h"

# Coloured output
alias ls="ls --color=auto"
alias grep="grep --color=auto"
#alias fgrep='fgrep --color=auto'
#alias egrep='egrep --color=auto'

# Easy access to ls options
alias la="ls -a"
alias ll="ls -lh"
alias lr="ls -R"

# Bash commands
alias c="clear"
alias x="exit"

# Systemd
alias reb="reboot"

# Gerar string a partir de /dev/urandom (http://www.commandlinefu.com/commands/view/7234/create-random-string-from-devurandom-or-another-length)
alias ger="cat /dev/urandom | tr -dc "[:alnum:]" | head -c64 && echo"
alias ger2="cat /dev/urandom | tr -dc "[:lower:]" | head -c64 && echo"

# Git log bonito (copiado do Reddit)
alias gitlog='git log --graph --oneline --all --decorate --pretty="%C(bold)%ad%C(reset) %C(yellow)%h%C(reset) %an %C(blue)%s" --date=format:"%y/%m/%d"'
alias gitl="git log --name-only"

# HTTP server
alias hs="python -m http.server"

# Browsing
alias_if gc cd ~/Code
alias_if g. cd ~/.local/opt/dotfiles
alias_if gt cd ~/.local/opt/scripts
alias_if gv cd ~/Vídeos
alias gd="cd ~/Downloads"
alias ga="cd /mnt/airport"
alias_if gar mount_and_cd /mnt/airport/romildo
alias_if gar mount_and_cd /mnt/airport/rafael
alias_if gad mount_and_cd /mnt/airport/Data


# Mirrors
## Manjaro
if command -v pacman-mirrors > /dev/null; then
	alias pm="sudo pacman-mirrors -f 10"
## Arch
elif command -v reflector > /dev/null; then
	alias pm="sudo reflector -l 5 --sort rate \
		--save /etc/pacman.d/mirrorlist && echo 'OK.' && sudo pacman -Syy"
fi

